<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>simpleMap</title>
		<script	src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
		<script src="https://apis.openapi.sk.com/tmap/jsv2?version=1&appKey=l7xx9c43f8a2b08440738fa8d5971261b2ae"></script>
		<script type="text/javascript">
			var markerInfo;
			var marker_p;
			var drawInfoArr2 = [];
			var chktraffic = [];
			var resultMarkerArr = [];
			var marker_s, marker_e, marker_p1, marker_p2;
			var totalMarkerArr = [];
			var drawInfoArr = [];
			var resultdrawArr = [];
			var map, marker;
			var markerArr = [], labelArr = [];
			var a,b,c,d;
            if (navigator.geolocation) { // GPS를 지원하면
                navigator.geolocation.getCurrentPosition(function(position) {
                  a= position.coords.latitude; 
                  b = position.coords.longitude;
                }, function(error) {
                  console.error(error);
                }, {
                  enableHighAccuracy: false,
                  maximumAge: 0,
                  timeout: Infinity
                });
              } else {
                alert('GPS를 지원하지 않습니다');
              }
			function initTmap() { // a,b에 위도경도 값을 넣어줄 것. 
				// 1. 지도 띄우기
				map = new Tmapv2.Map("map_div", {
					center : new Tmapv2.LatLng(a,b),
					width : "70%",
					height : "400px",
					zoom : 15,
					zoomControl : true,
					scrollwheel : true
				});
	
				// 2. POI 통합 검색 API 요청
				$("#btn_select").click(function(){
					var searchKeyword = '복지관;노인;'; //search 값을 노인복지시설 관련으로 fix 
					$.ajax({
						method:"GET", // 요청 방식
						url:"https://apis.openapi.sk.com/tmap/pois/search/around?version=1&format=json&callback=result", // url 주소
						data:{
							"categories" : searchKeyword,
							"resCoordType" : "EPSG3857",
							"searchType" : "name",
							"searchtypCd" : "A",
							"radius" : 1,
							"reqCoordType" : "WGS84GEO",
							"centerLon" : b,
							"centerLat" : a,
							"appKey" : "l7xx9c43f8a2b08440738fa8d5971261b2ae",
							"count" : 10
						},
						success:function(response){
							console.log(response);
							
							var resultpoisData = response.searchPoiInfo.pois.poi;
							
							// 2. 기존 마커, 팝업 제거
							if(markerArr.length > 0){
								for(var i in markerArr){
									markerArr[i].setMap(null);
								}
								markerArr = [];
							}
		
							if(labelArr.length > 0){
								for(var i in labelArr){
									labelArr[i].setMap(null);
								}
								labelArr = [];
							}
							
							var innerHtml = ""; // Search Reulsts 결과값 노출 위한 변수
							var positionBounds = new Tmapv2.LatLngBounds(); //맵에 결과물 확인 하기 위한 LatLngBounds객체 생성
							
							// 3. POI 마커 표시
							for(var k in resultpoisData){
								// POI 마커 정보 저장
								var noorLat = Number(resultpoisData[k].noorLat);
								var noorLon = Number(resultpoisData[k].noorLon);
								var name = resultpoisData[k].name;
								
								// POI 정보의 ID
								var id = resultpoisData[k].id;
								
								// 좌표 객체 생성
								var pointCng = new Tmapv2.Point(noorLon, noorLat);
								
								// EPSG3857좌표계를 WGS84GEO좌표계로 변환
								var projectionCng = new Tmapv2.Projection.convertEPSG3857ToWGS84GEO(pointCng);
								
								var lat = projectionCng._lat;
								var lon = projectionCng._lng;
								
								// 좌표 설정
								var markerPosition = new Tmapv2.LatLng(lat, lon);
								// Marker 설정
								marker = new Tmapv2.Marker({
							 		position : markerPosition,
							 		icon : "http://tmapapi.sktelecom.com/upload/tmap/marker/pin_b_m_" + k + ".png",
									iconSize : new Tmapv2.Size(24, 38),
									title : name,
									map:map
							 	});
								// 결과창에 나타날 검색 결과 html
								innerHtml += "<li><div><img src='http://tmapapi.sktelecom.com/upload/tmap/marker/pin_b_m_" 
								+ k + ".png' style='vertical-align:middle;'/><span>"+name+"</span>  "
								+"<button type='button' name='sendBtn' onClick='poiDetail("+id+");'>상세보기</button></div></li>"
								+"<button type='button' name='sendBtn2' onClick='route("+id+");'>보행자 경로 및 시간</button></div></li>"
								+"<button type='button' name='sendBtn3' onClick='car("+id+");'>자동차 경로 및 시간</button></div></li>";
								
								// 마커들을 담을 배열에 마커 저장
								markerArr.push(marker);
								positionBounds.extend(markerPosition);	// LatLngBounds의 객체 확장
							}
							
							$("#searchResult").html(innerHtml);	//searchResult 결과값 노출
							map.panToBounds(positionBounds);	// 확장된 bounds의 중심으로 이동시키기
							map.zoomOut();
						},
						error:function(request,status,error){
							console.log("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
						}
					});
				});
			}
			function car(poiId){
				$.ajax({
					method:"GET",
					url:"	https://apis.openapi.sk.com/tmap/pois/"+poiId+"?version=1&resCoordType=EPSG3857&format=json&callback=result&appKey="+"l7xx9c43f8a2b08440738fa8d5971261b2ae",
					async:true,
					success:function(response){
						var detailInfo = response.poiDetailInfo;
						console.log(detailInfo.name)
						var noorLat = Number(detailInfo.frontLat);
						var noorLon = Number(detailInfo.frontLon);
						
						var pointCng = new Tmapv2.Point(noorLon, noorLat);
                        //map.center = new Tmapv2.Point(noorLon, noorLat);
                        //map.zoom = 25;
						var projectionCng = new Tmapv2.Projection.convertEPSG3857ToWGS84GEO(pointCng);
						
						c = projectionCng._lat;
						d = projectionCng._lng;
						resettingMap();
		
						var searchOption = "0";

						var trafficInfochk ="N";

						//JSON TYPE EDIT [S]
						
						$.ajax({
							type : "POST",
							url : "https://apis.openapi.sk.com/tmap/routes?version=1&format=json&callback=result",
							async : false,
							data : {
								"appKey" : "l7xx9c43f8a2b08440738fa8d5971261b2ae",
								"startX" : b,
								"startY" : a,
								"endX" : d,
								"endY" : c,
								"reqCoordType" : "WGS84GEO",
								"resCoordType" : "EPSG3857",
								"searchOption" : searchOption,
								"trafficInfo" : trafficInfochk
							},
							success : function(response) {
								console.log(response)
								var resultData = response.features;

								var tDistance = "총 거리 : "
										+ (resultData[0].properties.totalDistance / 1000)
												.toFixed(1) + "km,";
								var tTime = "이동 시간 : "
										+ (resultData[0].properties.totalTime / 60)
												.toFixed(0) + "분,";
								var taxiFare = " 예상 택시 요금 : "
										+ resultData[0].properties.taxiFare
										+ "원";

								$("#result").text(
										tDistance + tTime + taxiFare);

								//교통정보 표출 옵션값을 체크
								if (trafficInfochk == "Y") {
									for ( var i in resultData) { //for문 [S]
										var geometry = resultData[i].geometry;
										var properties = resultData[i].properties;

										if (geometry.type == "LineString") {
											//교통 정보도 담음
											chktraffic
													.push(geometry.traffic);
											var sectionInfos = [];
											var trafficArr = geometry.traffic;

											for ( var j in geometry.coordinates) {
												// 경로들의 결과값들을 포인트 객체로 변환 
												var latlng = new Tmapv2.Point(
														geometry.coordinates[j][0],
														geometry.coordinates[j][1]);
												// 포인트 객체를 받아 좌표값으로 변환
												var convertPoint = new Tmapv2.Projection.convertEPSG3857ToWGS84GEO(
														latlng);

												sectionInfos
														.push(convertPoint);
											}

											drawLine(sectionInfos,
													trafficArr);
										} else {

											var markerImg = "";
											var pType = "";

											if (properties.pointType == "S") { //출발지 마커
												markerImg = "http://tmapapi.sktelecom.com/upload/tmap/marker/pin_r_m_s.png";
												pType = "S";
											} else if (properties.pointType == "E") { //도착지 마커
												markerImg = "http://tmapapi.sktelecom.com/upload/tmap/marker/pin_r_m_e.png";
												pType = "E";
											} else { //각 포인트 마커
												markerImg = "http://topopen.tmap.co.kr/imgs/point.png";
												pType = "P"
											}

											// 경로들의 결과값들을 포인트 객체로 변환 
											var latlon = new Tmapv2.Point(
													geometry.coordinates[0],
													geometry.coordinates[1]);
											// 포인트 객체를 받아 좌표값으로 다시 변환
											var convertPoint = new Tmapv2.Projection.convertEPSG3857ToWGS84GEO(
													latlon);

											var routeInfoObj = {
												markerImage : markerImg,
												lng : convertPoint._lng,
												lat : convertPoint._lat,
												pointType : pType
											};
											// 마커 추가
											addMarkers(routeInfoObj);
										}
									}//for문 [E]

								} else {

									for ( var i in resultData) { //for문 [S]
										var geometry = resultData[i].geometry;
										var properties = resultData[i].properties;

										if (geometry.type == "LineString") {
											for ( var j in geometry.coordinates) {
												// 경로들의 결과값들을 포인트 객체로 변환 
												var latlng = new Tmapv2.Point(
														geometry.coordinates[j][0],
														geometry.coordinates[j][1]);
												// 포인트 객체를 받아 좌표값으로 변환
												var convertPoint = new Tmapv2.Projection.convertEPSG3857ToWGS84GEO(
														latlng);
												// 포인트객체의 정보로 좌표값 변환 객체로 저장
												var convertChange = new Tmapv2.LatLng(
														convertPoint._lat,
														convertPoint._lng);
												// 배열에 담기
												drawInfoArr
														.push(convertChange);
											}
											drawLine(drawInfoArr,
													"0");
										} else {

											var markerImg = "";
											var pType = "";

											if (properties.pointType == "S") { //출발지 마커
												markerImg = "http://tmapapi.sktelecom.com/upload/tmap/marker/pin_r_m_s.png";
												pType = "S";
											} else if (properties.pointType == "E") { //도착지 마커
												markerImg = "http://tmapapi.sktelecom.com/upload/tmap/marker/pin_r_m_e.png";
												pType = "E";
											} else { //각 포인트 마커
												markerImg = "http://topopen.tmap.co.kr/imgs/point.png";
												pType = "P"
											}

											// 경로들의 결과값들을 포인트 객체로 변환 
											var latlon = new Tmapv2.Point(
													geometry.coordinates[0],
													geometry.coordinates[1]);
											// 포인트 객체를 받아 좌표값으로 다시 변환
											var convertPoint = new Tmapv2.Projection.convertEPSG3857ToWGS84GEO(
													latlon);

											var routeInfoObj = {
												markerImage : markerImg,
												lng : convertPoint._lng,
												lat : convertPoint._lat,
												pointType : pType
											};

											// Marker 추가
											addMarkers(routeInfoObj);
										}
									}//for문 [E]
								}
							},
							error : function(request, status, error) {
								console.log("code:"
										+ request.status + "\n"
										+ "message:"
										+ request.responseText
										+ "\n" + "error:" + error);
							}
						});

					}
				});
			}

			///////////////////////////////////////////////////////////////
			//보행자 거리
			function route(poiId){
				$.ajax({
					method:"GET",
					url:"	https://apis.openapi.sk.com/tmap/pois/"+poiId+"?version=1&resCoordType=EPSG3857&format=json&callback=result&appKey="+"l7xx9c43f8a2b08440738fa8d5971261b2ae",
					async:true,
					success:function(response){
						var detailInfo = response.poiDetailInfo;
						console.log(detailInfo.name)
						var noorLat = Number(detailInfo.frontLat);
						var noorLon = Number(detailInfo.frontLon);
						
						var pointCng = new Tmapv2.Point(noorLon, noorLat);
                        //map.center = new Tmapv2.Point(noorLon, noorLat);
                        //map.zoom = 25;
						var projectionCng = new Tmapv2.Projection.convertEPSG3857ToWGS84GEO(pointCng);
						
						c = projectionCng._lat;
						d = projectionCng._lng;
						$.ajax({
							method : "POST",
							url : "https://apis.openapi.sk.com/tmap/routes/pedestrian?version=1&format=json&callback=result",
							async : true,
							data : {
								"appKey" : "l7xx9c43f8a2b08440738fa8d5971261b2ae",
								"startX" : b,
								"startY" : a,
								"endX" : d,
								"endY" : c,
								"reqCoordType" : "WGS84GEO",
								"resCoordType" : "EPSG3857",
								"startName" : "출발지",
								"endName" : "도착지"
							},
							success : function(response) {
								if (marker_e){
									marker_e.setMap(null);
								}
								//출발
								console.log(d)
								marker_s = new Tmapv2.Marker(
									{
										position : new Tmapv2.LatLng(a, b),
										icon : "http://tmapapi.sktelecom.com/upload/tmap/marker/pin_r_m_s.png",
										iconSize : new Tmapv2.Size(24, 38),
										map : map
									});
		
								// 도착
								marker_e = new Tmapv2.Marker(
									{
										position : new Tmapv2.LatLng(c,d),
										icon : "http://tmapapi.sktelecom.com/upload/tmap/marker/pin_r_m_e.png",
										iconSize : new Tmapv2.Size(24, 38),
										map : map
									});
								var resultData = response.features;
								//결과 출력
								var tDistance = "총 거리 : "
										+ ((resultData[0].properties.totalDistance) / 1000)
												.toFixed(1) + "km,";
								var tTime = " 총 시간 : "
										+ ((resultData[0].properties.totalTime) / 60)
												.toFixed(0) + "분";
		
								$("#result").text(tDistance + tTime);
								
								//기존 그려진 라인 & 마커가 있다면 초기화
								if (resultdrawArr.length > 0) {
									for ( var i in resultdrawArr) {
										resultdrawArr[i]
												.setMap(null);
									}
									resultdrawArr = [];
								}
								
								drawInfoArr = [];
		
								for ( var i in resultData) { //for문 [S]
									var geometry = resultData[i].geometry;
									var properties = resultData[i].properties;
									var polyline_;
		
		
									if (geometry.type == "LineString") {
										for ( var j in geometry.coordinates) {
											// 경로들의 결과값(구간)들을 포인트 객체로 변환 
											var latlng = new Tmapv2.Point(
													geometry.coordinates[j][0],
													geometry.coordinates[j][1]);
											// 포인트 객체를 받아 좌표값으로 변환
											var convertPoint = new Tmapv2.Projection.convertEPSG3857ToWGS84GEO(
													latlng);
											// 포인트객체의 정보로 좌표값 변환 객체로 저장
											var convertChange = new Tmapv2.LatLng(
													convertPoint._lat,
													convertPoint._lng);
											// 배열에 담기
											drawInfoArr.push(convertChange);
										}
									} else {
										var markerImg = "";
										var pType = "";
										var size;
		
										if (properties.pointType == "S") { //출발지 마커
											markerImg = "http://tmapapi.sktelecom.com/upload/tmap/marker/pin_r_m_s.png";
											pType = "S";
											size = new Tmapv2.Size(24, 38);
										} else if (properties.pointType == "E") { //도착지 마커
											markerImg = "http://tmapapi.sktelecom.com/upload/tmap/marker/pin_r_m_e.png";
											pType = "E";
											size = new Tmapv2.Size(24, 38);
										} else { //각 포인트 마커
											markerImg = "http://topopen.tmap.co.kr/imgs/point.png";
											pType = "P";
											size = new Tmapv2.Size(8, 8);
										}
		
										// 경로들의 결과값들을 포인트 객체로 변환 
										var latlon = new Tmapv2.Point(
												geometry.coordinates[0],
												geometry.coordinates[1]);
		
										// 포인트 객체를 받아 좌표값으로 다시 변환
										var convertPoint = new Tmapv2.Projection.convertEPSG3857ToWGS84GEO(
												latlon);
		
										var routeInfoObj = {
											markerImage : markerImg,
											lng : convertPoint._lng,
											lat : convertPoint._lat,
											pointType : pType
										};
		
										// Marker 추가
										marker_p = new Tmapv2.Marker(
												{
													position : new Tmapv2.LatLng(
															routeInfoObj.lat,
															routeInfoObj.lng),
													icon : routeInfoObj.markerImage,
													iconSize : size,
													map : map
												});
									}
								}//for문 [E]
								drawLine1(drawInfoArr);
							},
							error : function(request, status, error) {
								console.log("code:" + request.status + "\n"
										+ "message:" + request.responseText + "\n"
										+ "error:" + error);
							}
						});

					}
				});
			

			}

			function addMarkers(infoObj) {
				var size = new Tmapv2.Size(24, 38);//아이콘 크기 설정합니다.
		
				if (infoObj.pointType == "P") { //포인트점일때는 아이콘 크기를 줄입니다.
					size = new Tmapv2.Size(8, 8);
				}
		
				marker_p = new Tmapv2.Marker({
					position : new Tmapv2.LatLng(infoObj.lat, infoObj.lng),
					icon : infoObj.markerImage,
					iconSize : size,
					map : map
				});
		
				resultMarkerArr.push(marker_p);
			}
		
			//라인그리기
			function drawLine(arrPoint, traffic) {
				var polyline_;
		
				if (chktraffic.length != 0) {
		
					// 교통정보 혼잡도를 체크
					// strokeColor는 교통 정보상황에 다라서 변화
					// traffic :  0-정보없음, 1-원활, 2-서행, 3-지체, 4-정체  (black, green, yellow, orange, red)
		
					var lineColor = "";
		
					if (traffic != "0") {
						if (traffic.length == 0) { //length가 0인것은 교통정보가 없으므로 검은색으로 표시
		
							lineColor = "#06050D";
							//라인그리기[S]
							polyline_ = new Tmapv2.Polyline({
								path : arrPoint,
								strokeColor : lineColor,
								strokeWeight : 4,
								map : map
							});
							resultdrawArr.push(polyline_);
							//라인그리기[E]
						} else { //교통정보가 있음
		
							if (traffic[0][0] != 0) { //교통정보 시작인덱스가 0이 아닌경우
								var trafficObject = "";
								var tInfo = [];
		
								for (var z = 0; z < traffic.length; z++) {
									trafficObject = {
										"startIndex" : traffic[z][0],
										"endIndex" : traffic[z][1],
										"trafficIndex" : traffic[z][2],
									};
									tInfo.push(trafficObject)
								}
		
								var noInfomationPoint = [];
		
								for (var p = 0; p < tInfo[0].startIndex; p++) {
									noInfomationPoint.push(arrPoint[p]);
								}
		
								//라인그리기[S]
								polyline_ = new Tmapv2.Polyline({
									path : noInfomationPoint,
									strokeColor : "#06050D",
									strokeWeight : 4,
									map : map
								});
								//라인그리기[E]
								resultdrawArr.push(polyline_);
		
								for (var x = 0; x < tInfo.length; x++) {
									var sectionPoint = []; //구간선언
		
									for (var y = tInfo[x].startIndex; y <= tInfo[x].endIndex; y++) {
										sectionPoint.push(arrPoint[y]);
									}
		
									if (tInfo[x].trafficIndex == 0) {
										lineColor = "#06050D";
									} else if (tInfo[x].trafficIndex == 1) {
										lineColor = "#61AB25";
									} else if (tInfo[x].trafficIndex == 2) {
										lineColor = "#FFFF00";
									} else if (tInfo[x].trafficIndex == 3) {
										lineColor = "#E87506";
									} else if (tInfo[x].trafficIndex == 4) {
										lineColor = "#D61125";
									}
		
									//라인그리기[S]
									polyline_ = new Tmapv2.Polyline({
										path : sectionPoint,
										strokeColor : lineColor,
										strokeWeight : 6,
										map : map
									});
									//라인그리기[E]
									resultdrawArr.push(polyline_);
								}
							} else { //0부터 시작하는 경우
		
								var trafficObject = "";
								var tInfo = [];
		
								for (var z = 0; z < traffic.length; z++) {
									trafficObject = {
										"startIndex" : traffic[z][0],
										"endIndex" : traffic[z][1],
										"trafficIndex" : traffic[z][2],
									};
									tInfo.push(trafficObject)
								}
		
								for (var x = 0; x < tInfo.length; x++) {
									var sectionPoint = []; //구간선언
		
									for (var y = tInfo[x].startIndex; y <= tInfo[x].endIndex; y++) {
										sectionPoint.push(arrPoint[y]);
									}
		
									if (tInfo[x].trafficIndex == 0) {
										lineColor = "#06050D";
									} else if (tInfo[x].trafficIndex == 1) {
										lineColor = "#61AB25";
									} else if (tInfo[x].trafficIndex == 2) {
										lineColor = "#FFFF00";
									} else if (tInfo[x].trafficIndex == 3) {
										lineColor = "#E87506";
									} else if (tInfo[x].trafficIndex == 4) {
										lineColor = "#D61125";
									}
		
									//라인그리기[S]
									polyline_ = new Tmapv2.Polyline({
										path : sectionPoint,
										strokeColor : lineColor,
										strokeWeight : 4,
										map : map
									});
									//라인그리기[E]
									resultdrawArr.push(polyline_);
								}
							}
						}
					} else {
		
					}
				} else {
					polyline_ = new Tmapv2.Polyline({
						path : arrPoint,
						strokeColor : "#DD0000",
						strokeWeight : 4,
						map : map
					});
					resultdrawArr.push(polyline_);
				}
		
			}
		
			//초기화 기능
			function resettingMap() {
				//기존마커는 삭제
				if(marker_e){
					marker_e.setMap(null);
				}
		
				if (resultMarkerArr.length > 0) {
					for (var i = 0; i < resultMarkerArr.length; i++) {
						resultMarkerArr[i].setMap(null);
					}
				}
		
				if (resultdrawArr.length > 0) {
					for (var i = 0; i < resultdrawArr.length; i++) {
						resultdrawArr[i].setMap(null);
					}
				}
		
				chktraffic = [];
				drawInfoArr = [];
				resultMarkerArr = [];
				resultdrawArr = [];
			}
			function addComma(num) {
				var regexp = /\B(?=(\d{3})+(?!\d))/g;
				return num.toString().replace(regexp, ',');
			}
			
			function drawLine1(arrPoint) {
				var polyline_;
		
				polyline_ = new Tmapv2.Polyline({
					path : arrPoint,
					strokeColor : "#DD0000",
					strokeWeight : 6,
					map : map
				});
				resultdrawArr.push(polyline_);
			}

			// 4. POI 상세 정보 API
			function poiDetail(poiId){
				$.ajax({
					method:"GET",
					url:"	https://apis.openapi.sk.com/tmap/pois/"+poiId+"?version=1&resCoordType=EPSG3857&format=json&callback=result&appKey="+"l7xx9c43f8a2b08440738fa8d5971261b2ae",
					async:false,
					success:function(response){
						var detailInfo = response.poiDetailInfo;
						var name = detailInfo.name;
                        var num = detailInfo.tel;
                        var address = detailInfo.address;
                        var homepageURL = detailInfo.homepageURL;
                        
						
						var noorLat = Number(detailInfo.frontLat);
						var noorLon = Number(detailInfo.frontLon);
						
						var pointCng = new Tmapv2.Point(noorLon, noorLat);
                        //map.center = new Tmapv2.Point(noorLon, noorLat);
                        //map.zoom = 25;
						var projectionCng = new Tmapv2.Projection.convertEPSG3857ToWGS84GEO(pointCng);
						
						var lat = projectionCng._lat;
						var lon = projectionCng._lng;
						
						var labelPosition = new Tmapv2.LatLng(lat, lon);
						var content = "<div class='m-pop' style='position: static; top: 180px; left : 320px; display: flex; font-size: 14px; box-shadow: 5px 5px 5px #00000040; border-radius: 10px; width : 400px; height:100px; background-color: #FFFFFF; align-items: center; padding: 5px;'>"+
                            "<div class='img-box' style='width: 110px; height: 90px; border-radius: 10px; background: #f5f5f5 url(./oldGuys.png) no-repeat center;'></div>"+
                            "<div class='info-box' style='margin-left : 10px'>"+
                            "<p style='margin-bottom: 7px;'>"+
                            "<span class='tit' style=' font-size: 16px; font-weight: bold;'>"+ name + "</span>"+
                            "<a href='"+homepageURL+"' target='_blank' class='link' style='color: #3D6DCC; font-size: 13px; margin-left: 10px;'>"+homepageURL+"</a></p>"+
                            "<p>"+
                            "<span class='new-addr'>" + address +"</span>"+
                            "</p>"+
                            "<p>"+
                            "<span class='new-tel'>" + num +"</span>"+
                            "</p>"+
                            "</div>"+
                            "<a href='javascript:void(0)' onclick='onClose()' class='btn-close' style='position: absolute; top: 10px; right: 10px; display: block; width: 15px; height: 15px; background: url(./xIcon.png) no-repeat center;'></a>"+
                            "</div>";
						var labelInfo = new Tmapv2.Label({
							position : labelPosition,
							content : content,
                           
							map:map
						});//popup 생성
						
						labelArr.push(labelInfo);
						function onClose(popup){
                            LatLng.setVisible(false);
                        }
					},
					error:function(request,status,error){
						console.log("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
					}
				});
			}
</script>
<body onload="initTmap();">
	<div>
		<!--<input type="text" class="text_custom" id="searchKeyword" name="searchKeyword" value="편의점;한의원;">	!-->
		<button id="btn_select">현재 위치에서 복지관 찾기</button>
	</div>
	<div>
		<div style="width: 30%; float:left;">
			<div class="title"><strong>Search</strong> Results</div>
			<div class="rst_wrap">
				<div class="rst mCustomScrollbar">
					<ul id="searchResult" name="searchResult">
						<li>검색결과</li>
					</ul>
				</div>
			</div>
		</div>
		<div id="map_div" class="map_wrap" style="float:left"></div>
	</div>
	<p id="result"></p>
</body>
</html>